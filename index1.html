<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pokedéx</title>
  <style>
    body {
      background-color: #eef2f7;
      font-family: 'Raleway', sans-serif;
    }
    .content {
      max-width: 900px;
      margin: 1rem auto;
      padding: 1rem;
      background-color: #fff;
      border-radius: 1rem;
    }
    h1 { text-align: center; }
    .pokemons {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
      padding: 0;
      list-style: none;
    }
    @media(min-width: 480px) { .pokemons { grid-template-columns: 1fr 1fr; } }
    @media(min-width: 768px) { .pokemons { grid-template-columns: 1fr 1fr 1fr; } }
    .pokemon {
      padding: 1rem;
      border-radius: 1rem;
      color: #fff;
      display: flex;
      flex-direction: column;
      text-align: center;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .pokemon:hover { transform: scale(1.05); }
    .pokemon .name { font-weight: bold; text-transform: capitalize; }
    .pokemon .number { opacity: 0.5; }
    .pokemon img { width: 80px; margin: 0 auto; }
    .types span {
      display: inline-block;
      background: rgba(255,255,255,0.2);
      margin: 2px;
      padding: 2px 6px;
      border-radius: 8px;
      font-size: 0.75rem;
    }
    .grass { background-color: #78C850; }
    .fire { background-color: #F08030; }
    .water { background-color: #6890F0; }
    .electric { background-color: #F8D030; }
    .psychic { background-color: #F85888; }
    .normal { background-color: #A8A878; }
    .ground { background-color: #E0C068; }
    .flying { background-color: #A890F0; }
    .bug { background-color: #A8B820; }
    .rock { background-color: #B8A038; }
    .ghost { background-color: #705898; }
    .dragon { background-color: #7038F8; }
    .fairy { background-color: #EE99AC; }
    .pagination {
      display: flex;
      justify-content: center;
      margin-top: 1rem;
    }
    .pagination button {
      padding: 0.5rem 1rem;
      background-color: #6c79db;
      color: #fff;
      border: none;
      border-radius: 0.5rem;
      cursor: pointer;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <section class="content">
    <h1>Minha Pokédex</h1>
    <ul id="pokemonList" class="pokemons"></ul>
    <div class="pagination">
      <button id="loadMoreButton">Carregar Mais</button>
    </div>
  </section>

  <script>
    class Pokemon {
      number;
      name;
      type;
      types = [];
      photo;
    }

    const pokeApi = {};
    function convertPokeApiDetailToPokemon(pokeDetail) {
      const pokemon = new Pokemon();
      pokemon.number = pokeDetail.id;
      pokemon.name = pokeDetail.name;
      const types = pokeDetail.types.map(slot => slot.type.name);
      const [type] = types;
      pokemon.types = types;
      pokemon.type = type;
      pokemon.photo = pokeDetail.sprites.other['official-artwork'].front_default;
      return pokemon;
    }
    pokeApi.getPokemonDetail = (pokemon) => {
      return fetch(pokemon.url)
        .then(response => response.json())
        .then(convertPokeApiDetailToPokemon);
    };
    pokeApi.getPokemons = (offset=0, limit=10) => {
      const url = `https://pokeapi.co/api/v2/pokemon?offset=${offset}&limit=${limit}`;
      return fetch(url)
        .then(response => response.json())
        .then(body => body.results)
        .then(pokemons => pokemons.map(pokeApi.getPokemonDetail))
        .then(details => Promise.all(details));
    };

    const pokemonList = document.getElementById('pokemonList');
    const loadMoreButton = document.getElementById('loadMoreButton');
    let offset = 0;
    const limit = 12;
    const maxRecords = 151;

    function convertPokemonToLi(pokemon) {
      return `
        <li class="pokemon ${pokemon.type}">
          <span class="number">#${pokemon.number}</span>
          <span class="name">${pokemon.name}</span>
          <img src="${pokemon.photo}" alt="${pokemon.name}">
          <div class="types">${pokemon.types.map(t => `<span>${t}</span>`).join('')}</div>
        </li>
      `;
    }

    function loadPokemons(offset, limit) {
      pokeApi.getPokemons(offset, limit).then(pokemons => {
        const newHtml = pokemons.map(convertPokemonToLi).join('');
        pokemonList.innerHTML += newHtml;
      });
    }

    loadPokemons(offset, limit);
    loadMoreButton.addEventListener('click', () => {
      offset += limit;
      const nextPage = offset + limit;
      if (nextPage >= maxRecords) {
        const newLimit = maxRecords - offset;
        loadPokemons(offset, newLimit);
        loadMoreButton.remove();
      } else {
        loadPokemons(offset, limit);
      }
    });
  </script>
</body>
</html>
